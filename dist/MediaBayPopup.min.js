!function(e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():window.MediaBayPopup=e()}((function(){let e=function(e,o){let t=this,n=function(e,o){for(let t in e)void 0===o[t]?o[t]=e[t]:"object"==typeof o[t]&&n(e[t],o[t])};return t.options=o||{},t.selector=e,t.defaults={popupClass:"active",bodyClass:"no-scroll",fakeScrollbarClass:"active",mainPopupClass:"MediaBayPopup",clickToClose:!0,escToClose:!0,allowPageScroll:!1,transitions:!0,animations:!1,fakeScrollbar:"#fake-scrollbar",popupId:""},n(t.defaults,t.options),t.init(),window.MediaBayPopups?window.MediaBayPopups[window.MediaBayPopups.length]=t:window.MediaBayPopups=[t],t.popup};return e.prototype.dispatchEvent=function(e,o){if("function"==typeof window.CustomEvent){const t=new CustomEvent(o);e.dispatchEvent(t)}},e.prototype.update=function(){const e=this.ctx||this;e.destroy(),e.init(e.selector)},e.prototype.destroy=function(){const e=this.ctx||this,o=e.popup,t=e.openButtons,n=e.closeButtons;if(o){if(o.classList.remove(e.options.mainPopupClass),o.removeEventListener(e.endEvent,e.transitionEnd),o.removeEventListener("click",e.closeByClick),document.removeEventListener("keyup",e.closePopupHandler),t)for(let o=0;o<t.length;o++)t[o]&&t[o].removeEventListener("click",e.openPopupHandler);if(n)for(let o=0;o<n.length;o++)n[o]&&n[o].removeEventListener("click",e.closePopupHandler)}},e.prototype.init=function(){const e=this,o=e.options;function t(e,o,t){return"string"==typeof o?t?document.querySelectorAll(o):document.querySelector(o):o}e.popup=t(e.popup,e.selector),e.openButtons=t(e.openButtons,o.openButtons,!0),e.closeButtons=t(e.closeButtons,o.closeButtons,!0),e.fakeScrollbar=t(e.fakeScrollbar,o.fakeScrollbar),e.popup.ctx=e,e.openPopupHandler={handleEvent:e.openPopup,ctx:e},e.closePopupHandler={handleEvent:e.closePopup,ctx:e},e.popup.open=e.openPopup,e.popup.close=e.closePopup,e.popup.update=e.update,e.popup.destroy=e.destroy,e.endEvent=o.transitions?"transitionend":!!o.animations&&"animationend",e.popup.classList.add(o.mainPopupClass),e.initEvents(),"none"===e.popup.style.display&&(e.popup.style.display="",e.popup.offsetWidth),e.dispatchEvent(e.popup,"init"),o.popupId&&-1!==location.hash.indexOf("#"+o.popupId)&&e.popup.open()},e.prototype.initEvents=function(){const e=this,o=e.openButtons,t=e.closeButtons;if(t)for(let o=0;o<t.length;o++)t[o]&&t[o].addEventListener("click",e.closePopupHandler);if(o)for(let t=0;t<o.length;t++)o[t]&&o[t].addEventListener("click",e.openPopupHandler);e.options.clickToClose&&e.popup.addEventListener("click",e.clickToClose),e.options.escToClose&&document.addEventListener("keyup",e.closePopupHandler)},e.prototype.transitionEnd=function(){const e=this.ctx||this,o=e.popup;"open"===e.action?e.dispatchEvent(o,"open"):(e.dispatchEvent(o,"close"),e.allowPageScroll()),o.removeEventListener(e.endEvent,e.transitionEnd)},e.prototype.closeByClick=function(){event.target===this&&this.closePopup()},e.prototype.openPopup=function(){const e=this.ctx||this,o=e.options,t=e.fakeScrollbar,n=document.body,p=e.popup;p.classList.contains(o.popupClass)||(event&&"click"===event.type&&(e.caller=p.caller=event.target),e.action="open",e.dispatchEvent(p,"beforeopen"),e.endEvent?p.addEventListener(e.endEvent,e.transitionEnd):e.dispatchEvent(p,"open"),p.classList.add(o.popupClass),t&&(t.classList.add(o.fakeScrollbarClass),n.classList.add(o.bodyClass),n.style.paddingRight=t.offsetWidth-t.clientWidth+"px"))},e.prototype.closePopup=function(){if(event&&"keyup"===event.type&&27!==event.keyCode)return;const e=this.ctx||this,o=e.options,t=e.popup;t.classList.contains(o.popupClass)&&(e.action="close",e.dispatchEvent(t,"beforeclose"),e.endEvent?t.addEventListener(e.endEvent,e.transitionEnd):(e.dispatchEvent(t,"close"),e.allowpagescroll()),t.classList.remove(o.popupClass))},e.prototype.allowPageScroll=function(){const e=this.ctx||this,o=e.options,t=e.fakeScrollbar,n=document.body,p=window.MediaBayPopups;t&&p.every((function(e){return!e.classList.contains(o.popupClass)}))&&(n.style.paddingRight="",t.classList.remove(o.fakeScrollbarClass),n.classList.remove(o.bodyClass))},e}));